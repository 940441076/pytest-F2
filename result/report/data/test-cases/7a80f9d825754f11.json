{"uid":"7a80f9d825754f11","name":"回撤","fullName":"testcases.scanImage.test_scanImage.Test_ScanImagePage#test_pullback","historyId":"43bfe13d1bd9ee1ea2a89edd932870cf","time":{"start":1688450884264,"stop":1688451182577,"duration":298313},"description":"回撤","descriptionHtml":"<p>回撤</p>\n","status":"failed","statusMessage":"AssertionError: assert False","statusTrace":"self = <test_scanImage.Test_ScanImagePage object at 0x000001CED3533910>\n\n    @allure.title('回撤')\n    def test_pullback(self):\n        allure.dynamic.description('回撤')\n        try:\n            app = common_util.connect_application()\n            common_util.back_scanImagePage()\n            with allure.step('6k:不同转速和距离'):\n                # 6k转\n                setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\", control_type=\"Button\")\n                setting_btn.click_input()\n                play_type = app['血管内断层成像系统'].child_window(auto_id=\"comLoop\", control_type=\"ComboBox\", found_index=0)\n                play_type.select(0)\n                play_speed = app['血管内断层成像系统'].child_window(auto_id=\"playbackSpeed\", control_type=\"Slider\", found_index=0)\n                play_speed.set_value(10)\n                k6_btn = app['血管内断层成像系统'].child_window(title=\"6k转\", auto_id=\"rbRotateSpeed6000\",control_type=\"RadioButton\", found_index=0)\n                k6_btn.click()\n                pull_len = app['血管内断层成像系统'].child_window(auto_id=\"comPullback\", control_type=\"ComboBox\")\n                pull_len.select(0)\n                pull_speed = app['血管内断层成像系统'].child_window(auto_id=\"comPullBackSped\", control_type=\"ComboBox\")\n                pull_speed.select(0)\n                content_len = pull_len.texts()\n                content_speed = pull_speed.texts()\n                for i in range(len(content_len)):\n                    setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\", control_type=\"Button\")\n                    if setting_close_btn.exists() == False:\n                        setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\", control_type=\"Button\")\n                        setting_btn.click_input()\n                    pull_len.select(i)\n                    for j in range(len(content_speed)):\n                        setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\", control_type=\"Button\")\n                        if setting_close_btn.exists() == False:\n                            setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\", control_type=\"Button\")\n                            setting_btn.click_input()\n                        pull_speed.select(j)\n                        time.sleep(1)\n                        common_util.screen_shot('距离/速度')\n                        setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\", control_type=\"Button\")\n                        setting_close_btn.click()\n                        time.sleep(1)\n                        dsa = common_util.read_systemInfo()\n                        if dsa['DSA'] == True:\n                            dsa_btn = app['血管内断层成像系统'].child_window(title=\"显示DSA\", control_type=\"Text\", found_index=0)\n                            if dsa_btn.exists():\n                                dsa_btn = app['血管内断层成像系统'].child_window(title=\"显示DSA\", auto_id=\"btnShow\",control_type=\"Button\")\n                                dsa_btn.click_input()\n                        time.sleep(1)\n                        scan_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                        scan_btn.click()\n                        time.sleep(5)\n                        if i == 0 and j == 0:\n                            calibration_btn = app['血管内断层成像系统'].child_window(auto_id=\"autoCalibration\",control_type=\"Button\")\n                            calibration_btn.click()\n                            time.sleep(13)\n                        ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\", control_type=\"Button\")\n                        if ok_btn.exists():\n                            ok_btn.click()\n                        else:\n                            stop_btn = app['血管内断层成像系统'].child_window(auto_id=\"stopScan\", control_type=\"Button\")\n                            stop_btn.click()\n                        scan_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                        scan_btn.click()\n                        time.sleep(5)\n                        ready_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                        ready_btn.click()\n                        time.sleep(5)\n                        pullback_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                        pullback_btn.click()\n                        reset_btn = app['血管内断层成像系统'].child_window(title=\"校准\", auto_id=\"btnResetShrink\",control_type=\"Button\").wait('enabled', timeout=180)\n                        assert reset_btn.is_enabled()\n                        mm_pos = app['血管内断层成像系统'].child_window(title=\"mm\", control_type=\"Text\", found_index=0)\n                        rect = mm_pos.rectangle().mid_point()\n                        mouse.click(coords=(rect.x, rect.y))\n                        play_btn = app['血管内断层成像系统'].child_window(auto_id=\"playBtn\", control_type=\"Button\")\n                        rect = play_btn.rectangle().mid_point()\n                        mouse.click(coords=(rect.x, rect.y))\n                        clip_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnClipImage\", control_type=\"Button\").wait(wait_for='enabled', timeout=12)\n                        if clip_btn.is_enabled():\n                            clip_btn = app['血管内断层成像系统'].child_window(auto_id=\"txtIndex\", control_type=\"Text\")\n                            frame_truth = int(clip_btn.texts()[0].split(': ')[-1])\n                            pullLen = content_len[i].split('mm')[0]\n                            pullSpeed = content_speed[j].split('mm')[0]\n                            frame_expect = int(int(pullLen) / int(pullSpeed) * 100)\n                            error = int(frame_expect * 0.05)\n                            assert abs(frame_expect - frame_truth)< error\n                        time.sleep(1)\n                        add_btn = app['血管内断层成像系统'].child_window(auto_id=\"addOCT\", control_type=\"Button\")\n                        add_btn.click()\n                        time.sleep(2)\n            with allure.step('12k:不同转速和距离'):\n                # 12k转\n                k12 = common_util.read_systemInfo()\n>               if k12['k12'] == True:\nE               KeyError: 'k12'\n\ntestcases\\scanImage\\test_scanImage.py:235: KeyError\n\nDuring handling of the above exception, another exception occurred:\n\nself = <test_scanImage.Test_ScanImagePage object at 0x000001CED3533910>\n\n    @allure.title('回撤')\n    def test_pullback(self):\n        allure.dynamic.description('回撤')\n        try:\n            app = common_util.connect_application()\n            common_util.back_scanImagePage()\n            with allure.step('6k:不同转速和距离'):\n                # 6k转\n                setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\", control_type=\"Button\")\n                setting_btn.click_input()\n                play_type = app['血管内断层成像系统'].child_window(auto_id=\"comLoop\", control_type=\"ComboBox\", found_index=0)\n                play_type.select(0)\n                play_speed = app['血管内断层成像系统'].child_window(auto_id=\"playbackSpeed\", control_type=\"Slider\", found_index=0)\n                play_speed.set_value(10)\n                k6_btn = app['血管内断层成像系统'].child_window(title=\"6k转\", auto_id=\"rbRotateSpeed6000\",control_type=\"RadioButton\", found_index=0)\n                k6_btn.click()\n                pull_len = app['血管内断层成像系统'].child_window(auto_id=\"comPullback\", control_type=\"ComboBox\")\n                pull_len.select(0)\n                pull_speed = app['血管内断层成像系统'].child_window(auto_id=\"comPullBackSped\", control_type=\"ComboBox\")\n                pull_speed.select(0)\n                content_len = pull_len.texts()\n                content_speed = pull_speed.texts()\n                for i in range(len(content_len)):\n                    setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\", control_type=\"Button\")\n                    if setting_close_btn.exists() == False:\n                        setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\", control_type=\"Button\")\n                        setting_btn.click_input()\n                    pull_len.select(i)\n                    for j in range(len(content_speed)):\n                        setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\", control_type=\"Button\")\n                        if setting_close_btn.exists() == False:\n                            setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\", control_type=\"Button\")\n                            setting_btn.click_input()\n                        pull_speed.select(j)\n                        time.sleep(1)\n                        common_util.screen_shot('距离/速度')\n                        setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\", control_type=\"Button\")\n                        setting_close_btn.click()\n                        time.sleep(1)\n                        dsa = common_util.read_systemInfo()\n                        if dsa['DSA'] == True:\n                            dsa_btn = app['血管内断层成像系统'].child_window(title=\"显示DSA\", control_type=\"Text\", found_index=0)\n                            if dsa_btn.exists():\n                                dsa_btn = app['血管内断层成像系统'].child_window(title=\"显示DSA\", auto_id=\"btnShow\",control_type=\"Button\")\n                                dsa_btn.click_input()\n                        time.sleep(1)\n                        scan_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                        scan_btn.click()\n                        time.sleep(5)\n                        if i == 0 and j == 0:\n                            calibration_btn = app['血管内断层成像系统'].child_window(auto_id=\"autoCalibration\",control_type=\"Button\")\n                            calibration_btn.click()\n                            time.sleep(13)\n                        ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\", control_type=\"Button\")\n                        if ok_btn.exists():\n                            ok_btn.click()\n                        else:\n                            stop_btn = app['血管内断层成像系统'].child_window(auto_id=\"stopScan\", control_type=\"Button\")\n                            stop_btn.click()\n                        scan_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                        scan_btn.click()\n                        time.sleep(5)\n                        ready_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                        ready_btn.click()\n                        time.sleep(5)\n                        pullback_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                        pullback_btn.click()\n                        reset_btn = app['血管内断层成像系统'].child_window(title=\"校准\", auto_id=\"btnResetShrink\",control_type=\"Button\").wait('enabled', timeout=180)\n                        assert reset_btn.is_enabled()\n                        mm_pos = app['血管内断层成像系统'].child_window(title=\"mm\", control_type=\"Text\", found_index=0)\n                        rect = mm_pos.rectangle().mid_point()\n                        mouse.click(coords=(rect.x, rect.y))\n                        play_btn = app['血管内断层成像系统'].child_window(auto_id=\"playBtn\", control_type=\"Button\")\n                        rect = play_btn.rectangle().mid_point()\n                        mouse.click(coords=(rect.x, rect.y))\n                        clip_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnClipImage\", control_type=\"Button\").wait(wait_for='enabled', timeout=12)\n                        if clip_btn.is_enabled():\n                            clip_btn = app['血管内断层成像系统'].child_window(auto_id=\"txtIndex\", control_type=\"Text\")\n                            frame_truth = int(clip_btn.texts()[0].split(': ')[-1])\n                            pullLen = content_len[i].split('mm')[0]\n                            pullSpeed = content_speed[j].split('mm')[0]\n                            frame_expect = int(int(pullLen) / int(pullSpeed) * 100)\n                            error = int(frame_expect * 0.05)\n                            assert abs(frame_expect - frame_truth)< error\n                        time.sleep(1)\n                        add_btn = app['血管内断层成像系统'].child_window(auto_id=\"addOCT\", control_type=\"Button\")\n                        add_btn.click()\n                        time.sleep(2)\n            with allure.step('12k:不同转速和距离'):\n                # 12k转\n                k12 = common_util.read_systemInfo()\n                if k12['k12'] == True:\n                    setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\", control_type=\"Button\")\n                    setting_btn.click_input()\n                    play_type = app['血管内断层成像系统'].child_window(auto_id=\"comLoop\", control_type=\"ComboBox\", found_index=0)\n                    play_type.select(0)\n                    play_speed = app['血管内断层成像系统'].child_window(auto_id=\"playbackSpeed\", control_type=\"Slider\", found_index=0)\n                    play_speed.set_value(10)\n                    pull_len = app['血管内断层成像系统'].child_window(auto_id=\"comPullback\", control_type=\"ComboBox\")\n                    pull_len.select(0)\n                    pull_speed = app['血管内断层成像系统'].child_window(auto_id=\"comPullBackSped\", control_type=\"ComboBox\")\n                    pull_speed.select(0)\n                    k12_btn = app['血管内断层成像系统'].child_window(title=\"12k转\", auto_id=\"rbRotateSpeed12000\",control_type=\"RadioButton\", found_index=0)\n                    k12_btn.click()\n                    content_len = pull_len.texts()\n                    content_speed = pull_speed.texts()\n                    for i in range(len(content_len)):\n                        setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\",control_type=\"Button\")\n                        if setting_close_btn.exists() == False:\n                            setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\", control_type=\"Button\")\n                            setting_btn.click_input()\n                        pull_len.select(i)\n                        pull_speed = app['血管内断层成像系统'].child_window(auto_id=\"comPullBackSped\", control_type=\"ComboBox\",found_index=0)\n                        for j in range(len(content_speed)):\n                            setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\",control_type=\"Button\")\n                            if setting_close_btn.exists() == False:\n                                setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\",control_type=\"Button\")\n                                setting_btn.click_input()\n                            pull_speed.select(j)\n                            time.sleep(1)\n                            common_util.screen_shot('距离/速度')\n                            setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\",control_type=\"Button\")\n                            setting_close_btn.click()\n                            dsa_btn = app['血管内断层成像系统'].child_window(title=\"显示DSA\", control_type=\"Text\", found_index=0)\n                            if dsa_btn.exists():\n                                dsa_btn = app['血管内断层成像系统'].child_window(title=\"显示DSA\", auto_id=\"btnShow\",control_type=\"Button\")\n                                dsa_btn.click_input()\n                            scan_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                            scan_btn.click()\n                            time.sleep(5)\n                            ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\", control_type=\"Button\")\n                            if ok_btn.exists():\n                                ok_btn.click()\n                            else:\n                                stop_btn = app['血管内断层成像系统'].child_window(auto_id=\"stopScan\", control_type=\"Button\")\n                                stop_btn.click()\n                            scan_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                            scan_btn.click()\n                            time.sleep(5)\n                            ready_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                            ready_btn.click()\n                            time.sleep(5)\n                            pullback_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                            pullback_btn.click()\n                            reset_btn = app['血管内断层成像系统'].child_window(title=\"校准\", auto_id=\"btnResetShrink\",control_type=\"Button\").wait('enabled', timeout=180)\n                            assert reset_btn.is_enabled()\n                            mm_pos = app['血管内断层成像系统'].child_window(title=\"mm\", control_type=\"Text\", found_index=0)\n                            rect = mm_pos.rectangle().mid_point()\n                            mouse.click(coords=(rect.x, rect.y))\n                            play_btn = app['血管内断层成像系统'].child_window(auto_id=\"playBtn\", control_type=\"Button\")\n                            rect = play_btn.rectangle().mid_point()\n                            mouse.click(coords=(rect.x, rect.y))\n                            clip_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnClipImage\", control_type=\"Button\").wait(wait_for='enabled', timeout=12)\n                            if clip_btn.is_enabled():\n                                clip_btn = app['血管内断层成像系统'].child_window(auto_id=\"txtIndex\", control_type=\"Text\")\n                                frame_truth = int(clip_btn.texts()[0].split(': ')[-1])\n                                pullLen = content_len[i].split('mm')[0]\n                                pullSpeed = content_speed[j].split('mm')[0]\n                                frame_expect = int(int(pullLen) / int(pullSpeed) * 200)\n                                error = int(frame_expect * 0.05)\n                                assert abs(frame_expect - frame_truth)< error\n                                time.sleep(1)\n                            add_btn = app['血管内断层成像系统'].child_window(auto_id=\"addOCT\", control_type=\"Button\")\n                            add_btn.click()\n                            time.sleep(2)\n        except Exception as e:\n            time.sleep(1)\n            common_util.screen_shot('异常截图')\n            time.sleep(1)\n            common_util.kill_app()\n            time.sleep(2)\n            common_util.connect_application()\n            common_util.add_text(str(e))\n>           assert False\nE           assert False\n\ntestcases\\scanImage\\test_scanImage.py:317: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_session_faker","time":{"start":1688449477056,"stop":1688449477108,"duration":52},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"hasContent":false,"shouldDisplayMessage":false,"attachmentsCount":0},{"name":"base_url","time":{"start":1688449477109,"stop":1688449477109,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"hasContent":false,"shouldDisplayMessage":false,"attachmentsCount":0},{"name":"environ","time":{"start":1688449477109,"stop":1688449477109,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"hasContent":false,"shouldDisplayMessage":false,"attachmentsCount":0},{"name":"_verify_url","time":{"start":1688449477109,"stop":1688449477109,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"hasContent":false,"shouldDisplayMessage":false,"attachmentsCount":0},{"name":"_xunit_setup_class_fixture_Test_ScanImagePage","time":{"start":1688450789045,"stop":1688450845059,"duration":56014},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"hasContent":false,"shouldDisplayMessage":false,"attachmentsCount":0}],"testStage":{"description":"回撤","status":"failed","statusMessage":"AssertionError: assert False","statusTrace":"self = <test_scanImage.Test_ScanImagePage object at 0x000001CED3533910>\n\n    @allure.title('回撤')\n    def test_pullback(self):\n        allure.dynamic.description('回撤')\n        try:\n            app = common_util.connect_application()\n            common_util.back_scanImagePage()\n            with allure.step('6k:不同转速和距离'):\n                # 6k转\n                setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\", control_type=\"Button\")\n                setting_btn.click_input()\n                play_type = app['血管内断层成像系统'].child_window(auto_id=\"comLoop\", control_type=\"ComboBox\", found_index=0)\n                play_type.select(0)\n                play_speed = app['血管内断层成像系统'].child_window(auto_id=\"playbackSpeed\", control_type=\"Slider\", found_index=0)\n                play_speed.set_value(10)\n                k6_btn = app['血管内断层成像系统'].child_window(title=\"6k转\", auto_id=\"rbRotateSpeed6000\",control_type=\"RadioButton\", found_index=0)\n                k6_btn.click()\n                pull_len = app['血管内断层成像系统'].child_window(auto_id=\"comPullback\", control_type=\"ComboBox\")\n                pull_len.select(0)\n                pull_speed = app['血管内断层成像系统'].child_window(auto_id=\"comPullBackSped\", control_type=\"ComboBox\")\n                pull_speed.select(0)\n                content_len = pull_len.texts()\n                content_speed = pull_speed.texts()\n                for i in range(len(content_len)):\n                    setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\", control_type=\"Button\")\n                    if setting_close_btn.exists() == False:\n                        setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\", control_type=\"Button\")\n                        setting_btn.click_input()\n                    pull_len.select(i)\n                    for j in range(len(content_speed)):\n                        setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\", control_type=\"Button\")\n                        if setting_close_btn.exists() == False:\n                            setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\", control_type=\"Button\")\n                            setting_btn.click_input()\n                        pull_speed.select(j)\n                        time.sleep(1)\n                        common_util.screen_shot('距离/速度')\n                        setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\", control_type=\"Button\")\n                        setting_close_btn.click()\n                        time.sleep(1)\n                        dsa = common_util.read_systemInfo()\n                        if dsa['DSA'] == True:\n                            dsa_btn = app['血管内断层成像系统'].child_window(title=\"显示DSA\", control_type=\"Text\", found_index=0)\n                            if dsa_btn.exists():\n                                dsa_btn = app['血管内断层成像系统'].child_window(title=\"显示DSA\", auto_id=\"btnShow\",control_type=\"Button\")\n                                dsa_btn.click_input()\n                        time.sleep(1)\n                        scan_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                        scan_btn.click()\n                        time.sleep(5)\n                        if i == 0 and j == 0:\n                            calibration_btn = app['血管内断层成像系统'].child_window(auto_id=\"autoCalibration\",control_type=\"Button\")\n                            calibration_btn.click()\n                            time.sleep(13)\n                        ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\", control_type=\"Button\")\n                        if ok_btn.exists():\n                            ok_btn.click()\n                        else:\n                            stop_btn = app['血管内断层成像系统'].child_window(auto_id=\"stopScan\", control_type=\"Button\")\n                            stop_btn.click()\n                        scan_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                        scan_btn.click()\n                        time.sleep(5)\n                        ready_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                        ready_btn.click()\n                        time.sleep(5)\n                        pullback_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                        pullback_btn.click()\n                        reset_btn = app['血管内断层成像系统'].child_window(title=\"校准\", auto_id=\"btnResetShrink\",control_type=\"Button\").wait('enabled', timeout=180)\n                        assert reset_btn.is_enabled()\n                        mm_pos = app['血管内断层成像系统'].child_window(title=\"mm\", control_type=\"Text\", found_index=0)\n                        rect = mm_pos.rectangle().mid_point()\n                        mouse.click(coords=(rect.x, rect.y))\n                        play_btn = app['血管内断层成像系统'].child_window(auto_id=\"playBtn\", control_type=\"Button\")\n                        rect = play_btn.rectangle().mid_point()\n                        mouse.click(coords=(rect.x, rect.y))\n                        clip_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnClipImage\", control_type=\"Button\").wait(wait_for='enabled', timeout=12)\n                        if clip_btn.is_enabled():\n                            clip_btn = app['血管内断层成像系统'].child_window(auto_id=\"txtIndex\", control_type=\"Text\")\n                            frame_truth = int(clip_btn.texts()[0].split(': ')[-1])\n                            pullLen = content_len[i].split('mm')[0]\n                            pullSpeed = content_speed[j].split('mm')[0]\n                            frame_expect = int(int(pullLen) / int(pullSpeed) * 100)\n                            error = int(frame_expect * 0.05)\n                            assert abs(frame_expect - frame_truth)< error\n                        time.sleep(1)\n                        add_btn = app['血管内断层成像系统'].child_window(auto_id=\"addOCT\", control_type=\"Button\")\n                        add_btn.click()\n                        time.sleep(2)\n            with allure.step('12k:不同转速和距离'):\n                # 12k转\n                k12 = common_util.read_systemInfo()\n>               if k12['k12'] == True:\nE               KeyError: 'k12'\n\ntestcases\\scanImage\\test_scanImage.py:235: KeyError\n\nDuring handling of the above exception, another exception occurred:\n\nself = <test_scanImage.Test_ScanImagePage object at 0x000001CED3533910>\n\n    @allure.title('回撤')\n    def test_pullback(self):\n        allure.dynamic.description('回撤')\n        try:\n            app = common_util.connect_application()\n            common_util.back_scanImagePage()\n            with allure.step('6k:不同转速和距离'):\n                # 6k转\n                setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\", control_type=\"Button\")\n                setting_btn.click_input()\n                play_type = app['血管内断层成像系统'].child_window(auto_id=\"comLoop\", control_type=\"ComboBox\", found_index=0)\n                play_type.select(0)\n                play_speed = app['血管内断层成像系统'].child_window(auto_id=\"playbackSpeed\", control_type=\"Slider\", found_index=0)\n                play_speed.set_value(10)\n                k6_btn = app['血管内断层成像系统'].child_window(title=\"6k转\", auto_id=\"rbRotateSpeed6000\",control_type=\"RadioButton\", found_index=0)\n                k6_btn.click()\n                pull_len = app['血管内断层成像系统'].child_window(auto_id=\"comPullback\", control_type=\"ComboBox\")\n                pull_len.select(0)\n                pull_speed = app['血管内断层成像系统'].child_window(auto_id=\"comPullBackSped\", control_type=\"ComboBox\")\n                pull_speed.select(0)\n                content_len = pull_len.texts()\n                content_speed = pull_speed.texts()\n                for i in range(len(content_len)):\n                    setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\", control_type=\"Button\")\n                    if setting_close_btn.exists() == False:\n                        setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\", control_type=\"Button\")\n                        setting_btn.click_input()\n                    pull_len.select(i)\n                    for j in range(len(content_speed)):\n                        setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\", control_type=\"Button\")\n                        if setting_close_btn.exists() == False:\n                            setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\", control_type=\"Button\")\n                            setting_btn.click_input()\n                        pull_speed.select(j)\n                        time.sleep(1)\n                        common_util.screen_shot('距离/速度')\n                        setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\", control_type=\"Button\")\n                        setting_close_btn.click()\n                        time.sleep(1)\n                        dsa = common_util.read_systemInfo()\n                        if dsa['DSA'] == True:\n                            dsa_btn = app['血管内断层成像系统'].child_window(title=\"显示DSA\", control_type=\"Text\", found_index=0)\n                            if dsa_btn.exists():\n                                dsa_btn = app['血管内断层成像系统'].child_window(title=\"显示DSA\", auto_id=\"btnShow\",control_type=\"Button\")\n                                dsa_btn.click_input()\n                        time.sleep(1)\n                        scan_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                        scan_btn.click()\n                        time.sleep(5)\n                        if i == 0 and j == 0:\n                            calibration_btn = app['血管内断层成像系统'].child_window(auto_id=\"autoCalibration\",control_type=\"Button\")\n                            calibration_btn.click()\n                            time.sleep(13)\n                        ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\", control_type=\"Button\")\n                        if ok_btn.exists():\n                            ok_btn.click()\n                        else:\n                            stop_btn = app['血管内断层成像系统'].child_window(auto_id=\"stopScan\", control_type=\"Button\")\n                            stop_btn.click()\n                        scan_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                        scan_btn.click()\n                        time.sleep(5)\n                        ready_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                        ready_btn.click()\n                        time.sleep(5)\n                        pullback_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                        pullback_btn.click()\n                        reset_btn = app['血管内断层成像系统'].child_window(title=\"校准\", auto_id=\"btnResetShrink\",control_type=\"Button\").wait('enabled', timeout=180)\n                        assert reset_btn.is_enabled()\n                        mm_pos = app['血管内断层成像系统'].child_window(title=\"mm\", control_type=\"Text\", found_index=0)\n                        rect = mm_pos.rectangle().mid_point()\n                        mouse.click(coords=(rect.x, rect.y))\n                        play_btn = app['血管内断层成像系统'].child_window(auto_id=\"playBtn\", control_type=\"Button\")\n                        rect = play_btn.rectangle().mid_point()\n                        mouse.click(coords=(rect.x, rect.y))\n                        clip_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnClipImage\", control_type=\"Button\").wait(wait_for='enabled', timeout=12)\n                        if clip_btn.is_enabled():\n                            clip_btn = app['血管内断层成像系统'].child_window(auto_id=\"txtIndex\", control_type=\"Text\")\n                            frame_truth = int(clip_btn.texts()[0].split(': ')[-1])\n                            pullLen = content_len[i].split('mm')[0]\n                            pullSpeed = content_speed[j].split('mm')[0]\n                            frame_expect = int(int(pullLen) / int(pullSpeed) * 100)\n                            error = int(frame_expect * 0.05)\n                            assert abs(frame_expect - frame_truth)< error\n                        time.sleep(1)\n                        add_btn = app['血管内断层成像系统'].child_window(auto_id=\"addOCT\", control_type=\"Button\")\n                        add_btn.click()\n                        time.sleep(2)\n            with allure.step('12k:不同转速和距离'):\n                # 12k转\n                k12 = common_util.read_systemInfo()\n                if k12['k12'] == True:\n                    setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\", control_type=\"Button\")\n                    setting_btn.click_input()\n                    play_type = app['血管内断层成像系统'].child_window(auto_id=\"comLoop\", control_type=\"ComboBox\", found_index=0)\n                    play_type.select(0)\n                    play_speed = app['血管内断层成像系统'].child_window(auto_id=\"playbackSpeed\", control_type=\"Slider\", found_index=0)\n                    play_speed.set_value(10)\n                    pull_len = app['血管内断层成像系统'].child_window(auto_id=\"comPullback\", control_type=\"ComboBox\")\n                    pull_len.select(0)\n                    pull_speed = app['血管内断层成像系统'].child_window(auto_id=\"comPullBackSped\", control_type=\"ComboBox\")\n                    pull_speed.select(0)\n                    k12_btn = app['血管内断层成像系统'].child_window(title=\"12k转\", auto_id=\"rbRotateSpeed12000\",control_type=\"RadioButton\", found_index=0)\n                    k12_btn.click()\n                    content_len = pull_len.texts()\n                    content_speed = pull_speed.texts()\n                    for i in range(len(content_len)):\n                        setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\",control_type=\"Button\")\n                        if setting_close_btn.exists() == False:\n                            setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\", control_type=\"Button\")\n                            setting_btn.click_input()\n                        pull_len.select(i)\n                        pull_speed = app['血管内断层成像系统'].child_window(auto_id=\"comPullBackSped\", control_type=\"ComboBox\",found_index=0)\n                        for j in range(len(content_speed)):\n                            setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\",control_type=\"Button\")\n                            if setting_close_btn.exists() == False:\n                                setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\",control_type=\"Button\")\n                                setting_btn.click_input()\n                            pull_speed.select(j)\n                            time.sleep(1)\n                            common_util.screen_shot('距离/速度')\n                            setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\",control_type=\"Button\")\n                            setting_close_btn.click()\n                            dsa_btn = app['血管内断层成像系统'].child_window(title=\"显示DSA\", control_type=\"Text\", found_index=0)\n                            if dsa_btn.exists():\n                                dsa_btn = app['血管内断层成像系统'].child_window(title=\"显示DSA\", auto_id=\"btnShow\",control_type=\"Button\")\n                                dsa_btn.click_input()\n                            scan_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                            scan_btn.click()\n                            time.sleep(5)\n                            ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\", control_type=\"Button\")\n                            if ok_btn.exists():\n                                ok_btn.click()\n                            else:\n                                stop_btn = app['血管内断层成像系统'].child_window(auto_id=\"stopScan\", control_type=\"Button\")\n                                stop_btn.click()\n                            scan_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                            scan_btn.click()\n                            time.sleep(5)\n                            ready_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                            ready_btn.click()\n                            time.sleep(5)\n                            pullback_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                            pullback_btn.click()\n                            reset_btn = app['血管内断层成像系统'].child_window(title=\"校准\", auto_id=\"btnResetShrink\",control_type=\"Button\").wait('enabled', timeout=180)\n                            assert reset_btn.is_enabled()\n                            mm_pos = app['血管内断层成像系统'].child_window(title=\"mm\", control_type=\"Text\", found_index=0)\n                            rect = mm_pos.rectangle().mid_point()\n                            mouse.click(coords=(rect.x, rect.y))\n                            play_btn = app['血管内断层成像系统'].child_window(auto_id=\"playBtn\", control_type=\"Button\")\n                            rect = play_btn.rectangle().mid_point()\n                            mouse.click(coords=(rect.x, rect.y))\n                            clip_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnClipImage\", control_type=\"Button\").wait(wait_for='enabled', timeout=12)\n                            if clip_btn.is_enabled():\n                                clip_btn = app['血管内断层成像系统'].child_window(auto_id=\"txtIndex\", control_type=\"Text\")\n                                frame_truth = int(clip_btn.texts()[0].split(': ')[-1])\n                                pullLen = content_len[i].split('mm')[0]\n                                pullSpeed = content_speed[j].split('mm')[0]\n                                frame_expect = int(int(pullLen) / int(pullSpeed) * 200)\n                                error = int(frame_expect * 0.05)\n                                assert abs(frame_expect - frame_truth)< error\n                                time.sleep(1)\n                            add_btn = app['血管内断层成像系统'].child_window(auto_id=\"addOCT\", control_type=\"Button\")\n                            add_btn.click()\n                            time.sleep(2)\n        except Exception as e:\n            time.sleep(1)\n            common_util.screen_shot('异常截图')\n            time.sleep(1)\n            common_util.kill_app()\n            time.sleep(2)\n            common_util.connect_application()\n            common_util.add_text(str(e))\n>           assert False\nE           assert False\n\ntestcases\\scanImage\\test_scanImage.py:317: AssertionError","steps":[{"name":"6k:不同转速和距离","time":{"start":1688450888767,"stop":1688451162916,"duration":274149},"status":"passed","steps":[],"attachments":[{"uid":"8c187a6ece8c0d2d","name":"距离/速度","source":"8c187a6ece8c0d2d.jpg","type":"image/jpg","size":61386},{"uid":"a4380744249ae968","name":"距离/速度","source":"a4380744249ae968.jpg","type":"image/jpg","size":61458},{"uid":"de3616f8bb128639","name":"距离/速度","source":"de3616f8bb128639.jpg","type":"image/jpg","size":61491},{"uid":"5db3a8634d734746","name":"距离/速度","source":"5db3a8634d734746.jpg","type":"image/jpg","size":61418}],"parameters":[],"stepsCount":0,"hasContent":true,"shouldDisplayMessage":false,"attachmentsCount":4},{"name":"12k:不同转速和距离","time":{"start":1688451162916,"stop":1688451162920,"duration":4},"status":"broken","statusMessage":"KeyError: 'k12'\n","statusTrace":"  File \"D:\\workspace\\myPytest\\F2\\testcases\\scanImage\\test_scanImage.py\", line 235, in test_pullback\n    if k12['k12'] == True:\n       ~~~^^^^^^^\n","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"hasContent":true,"shouldDisplayMessage":true,"attachmentsCount":0}],"attachments":[{"uid":"7c3ff57a0ca8f5e0","name":"异常截图","source":"7c3ff57a0ca8f5e0.jpg","type":"image/jpg","size":50046},{"uid":"d8920148bf2258d9","name":"'k12'","source":"d8920148bf2258d9.txt","type":"text/plain","size":0}],"parameters":[],"stepsCount":2,"hasContent":true,"shouldDisplayMessage":true,"attachmentsCount":6},"afterStages":[{"name":"_xunit_setup_class_fixture_Test_ScanImagePage::0","time":{"start":1688451206126,"stop":1688451206126,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"hasContent":false,"shouldDisplayMessage":false,"attachmentsCount":0}],"labels":[{"name":"feature","value":"扫描图像界面"},{"name":"tag","value":"run(order=5)"},{"name":"parentSuite","value":"testcases.scanImage"},{"name":"suite","value":"test_scanImage"},{"name":"subSuite","value":"Test_ScanImagePage"},{"name":"host","value":"DESKTOP-8BNU2EL"},{"name":"thread","value":"7516-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"testcases.scanImage.test_scanImage"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":["run(order=5)"]},"source":"7a80f9d825754f11.json","parameterValues":[]}